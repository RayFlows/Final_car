<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Face Recognition Unlock System</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
</head>
<body>
    <div class="container">
        <h1>Face Recognition to Unlock</h1>
        <div class="video-container">
            <!-- 使用新的视频流 -->
            <img src="{{ url_for('local_video_feed') }}" alt="摄像头预览">
        </div>
        <div class="status" id="status">
            {{ auth_message }}
        </div>
        <div class="instructions">
            <p>Please ensure that：</p>
            <ul>
                <li>The face is in the center of the frame.</li>
                <li>There is sufficient lighting.</li>
                <li>No other faces are present in the frame.</li>
            </ul>
        </div>
    </div>
    
    <script>
        // 检查认证状态
        function checkAuthStatus() {
            fetch('/auth_status')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('status').textContent = data.message;
                    if (data.authenticated) {
                        window.location.href = '/unlocked';
                    }
                });
        }
        
        // 每2秒检查一次认证状态
        setInterval(checkAuthStatus, 2000);
    </script>
</body>
</html>